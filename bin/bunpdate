#!/bin/bash
# Usage: bunpdate [ARGS]
#
# Executes 'bundle update' with the given arguments with the current './Gemfile'
# and all gemfiles in the './gemfiles' directory.

set -e

__bunpdate__() {
  if [[ -f $1 ]]; then
    echo -e "ðŸ’Ž \033[00mUpdating \033[0;31m$1\033[00m..."
    BUNDLE_GEMFILE=$1 bundle update $2 --quiet
  fi
}

__bunpdate__ 'Gemfile' "$*"
__bunpdate__ 'gems.rb' "$*"

for gemfile in $(ls gemfiles/Gemfile* 2>/dev/null | grep -v 'lock$'); do
  __bunpdate__ $gemfile "$*"
done

for gemfile in $(ls gemfiles/gems*.rb 2>/dev/null); do
  __bunpdate__ $gemfile "$*"
done
